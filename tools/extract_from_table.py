#!/usr/bin/env python3
from pprint import pprint
import re
from bs4 import BeautifulSoup
import json


table_content='<table class="statistics" cellspacing="0"><tr><th>Systems</th><th>Cuesheets</th><th>Datfiles</th><th>Subchannels</th><th>Disc Keys</th><th>BIOS Datfiles</th></tr><tr><td>Acorn Archimedes</td><td><a href="/cues/arch/">Cuesheets</a></td><td><a href="/datfile/arch/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Apple Macintosh</td><td><a href="/cues/mac/">Cuesheets</a></td><td><a href="/datfile/mac/">Datfile</a></td><td><a href="/sbi/mac/">SBI</a> | LSD</td><td></td><td></td></tr><tr><td>Atari Jaguar CD Interactive Multimedia System</td><td><a href="/cues/ajcd/">Cuesheets</a></td><td><a href="/datfile/ajcd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Audio CD</td><td><a href="/cues/audio-cd/">Cuesheets</a></td><td><a href="/datfile/audio-cd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Bandai Pippin</td><td><a href="/cues/pippin/">Cuesheets</a></td><td><a href="/datfile/pippin/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Bandai Playdia Quick Interactive System</td><td><a href="/cues/qis/">Cuesheets</a></td><td><a href="/datfile/qis/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>BD-Video</td><td></td><td><a href="/datfile/bd-video/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Commodore Amiga CD</td><td><a href="/cues/acd/">Cuesheets</a></td><td><a href="/datfile/acd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Commodore Amiga CD32</td><td><a href="/cues/cd32/">Cuesheets</a></td><td><a href="/datfile/cd32/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Commodore Amiga CDTV</td><td><a href="/cues/cdtv/">Cuesheets</a></td><td><a href="/datfile/cdtv/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>DVD-Video</td><td></td><td><a href="/datfile/dvd-video/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Fujitsu FM Towns series</td><td><a href="/cues/fmt/">Cuesheets</a></td><td><a href="/datfile/fmt/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>funworld Photo Play</td><td><a href="/cues/fpp/">Cuesheets</a></td><td><a href="/datfile/fpp/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Hasbro VideoNow</td><td><a href="/cues/hvn/">Cuesheets</a></td><td><a href="/datfile/hvn/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Hasbro VideoNow Color</td><td><a href="/cues/hvnc/">Cuesheets</a></td><td><a href="/datfile/hvnc/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Hasbro VideoNow Jr.</td><td><a href="/cues/hvnjr/">Cuesheets</a></td><td><a href="/datfile/hvnjr/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Hasbro VideoNow XP</td><td><a href="/cues/hvnxp/">Cuesheets</a></td><td><a href="/datfile/hvnxp/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>HD DVD-Video</td><td></td><td><a href="/datfile/hddvd-video/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>IBM PC compatible</td><td><a href="/cues/pc/">Cuesheets</a></td><td><a href="/datfile/pc/">Datfile</a></td><td><a href="/sbi/pc/">SBI</a> | LSD</td><td></td><td></td></tr><tr><td>Incredible Technologies Eagle</td><td><a href="/cues/ite/">Cuesheets</a></td><td><a href="/datfile/ite/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Konami e-Amusement</td><td><a href="/cues/kea/">Cuesheets</a></td><td><a href="/datfile/kea/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Konami FireBeat</td><td><a href="/cues/kfb/">Cuesheets</a></td><td><a href="/datfile/kfb/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Konami M2</td><td><a href="/cues/km2/">Cuesheets</a></td><td><a href="/datfile/km2/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Konami System 573</td><td><a href="/cues/ks573/">Cuesheets</a></td><td><a href="/datfile/ks573/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Konami System GV</td><td><a href="/cues/ksgv/">Cuesheets</a></td><td><a href="/datfile/ksgv/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Konami Twinkle</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Mattel Fisher-Price iXL</td><td><a href="/cues/ixl/">Cuesheets</a></td><td><a href="/datfile/ixl/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Mattel HyperScan</td><td><a href="/cues/hs/">Cuesheets</a></td><td><a href="/datfile/hs/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Memorex Visual Information System</td><td><a href="/cues/vis/">Cuesheets</a></td><td><a href="/datfile/vis/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Microsoft Xbox</td><td><a href="/cues/xbox/">Cuesheets</a></td><td><a href="/datfile/xbox/">Datfile</a></td><td></td><td></td><td><a href="/datfile/xbox-bios/">BIOS Datfile</a></td></tr><tr><td>Microsoft Xbox 360</td><td><a href="/cues/xbox360/">Cuesheets</a></td><td><a href="/datfile/xbox360/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Microsoft Xbox One</td><td></td><td><a href="/datfile/xboxone/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Microsoft Xbox Series X</td><td></td><td><a href="/datfile/xboxsx/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Namco · Sega · Nintendo Triforce</td><td><a href="/cues/trf/">Cuesheets</a> | <a href="/gdi/trf/">GDI Files</a></td><td><a href="/datfile/trf/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Namco System 12</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Namco System 246</td><td><a href="/cues/ns246/">Cuesheets</a></td><td><a href="/datfile/ns246/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Navisoft Naviken 2.1</td><td><a href="/cues/navi21/">Cuesheets</a></td><td><a href="/datfile/navi21/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>NEC PC Engine CD & TurboGrafx CD</td><td><a href="/cues/pce/">Cuesheets</a></td><td><a href="/datfile/pce/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>NEC PC-88 series</td><td><a href="/cues/pc-88/">Cuesheets</a></td><td><a href="/datfile/pc-88/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>NEC PC-98 series</td><td><a href="/cues/pc-98/">Cuesheets</a></td><td><a href="/datfile/pc-98/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>NEC PC-FX & PC-FXGA</td><td><a href="/cues/pc-fx/">Cuesheets</a></td><td><a href="/datfile/pc-fx/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Neo Geo CD</td><td><a href="/cues/ngcd/">Cuesheets</a></td><td><a href="/datfile/ngcd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Nintendo GameCube</td><td></td><td><a href="/datfile/gc/">Datfile</a></td><td></td><td></td><td><a href="/datfile/gc-bios/">BIOS Datfile</a></td></tr><tr><td>Nintendo Wii</td><td></td><td><a href="/datfile/wii/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Nintendo Wii U</td><td></td><td><a href="/datfile/wiiu/">Datfile</a></td><td></td><td><a href="/keys/wiiu/">HEX</a></td><td></td></tr><tr><td>Palm OS</td><td><a href="/cues/palm/">Cuesheets</a></td><td><a href="/datfile/palm/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Panasonic 3DO Interactive Multiplayer</td><td><a href="/cues/3do/">Cuesheets</a></td><td><a href="/datfile/3do/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Panasonic M2</td><td><a href="/cues/m2/">Cuesheets</a></td><td><a href="/datfile/m2/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Philips CD-i</td><td><a href="/cues/cdi/">Cuesheets</a></td><td><a href="/datfile/cdi/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Photo CD</td><td><a href="/cues/photo-cd/">Cuesheets</a></td><td><a href="/datfile/photo-cd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>PlayStation GameShark Updates</td><td><a href="/cues/psxgs/">Cuesheets</a></td><td><a href="/datfile/psxgs/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Pocket PC</td><td><a href="/cues/ppc/">Cuesheets</a></td><td><a href="/datfile/ppc/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Chihiro</td><td><a href="/cues/chihiro/">Cuesheets</a> | <a href="/gdi/chihiro/">GDI Files</a></td><td><a href="/datfile/chihiro/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Dreamcast</td><td><a href="/cues/dc/">Cuesheets</a> | <a href="/gdi/dc/">GDI Files</a></td><td><a href="/datfile/dc/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Lindbergh</td><td></td><td><a href="/datfile/lindbergh/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Mega CD & Sega CD</td><td><a href="/cues/mcd/">Cuesheets</a></td><td><a href="/datfile/mcd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Naomi</td><td><a href="/cues/naomi/">Cuesheets</a> | <a href="/gdi/naomi/">GDI Files</a></td><td><a href="/datfile/naomi/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Naomi 2</td><td><a href="/cues/naomi2/">Cuesheets</a> | <a href="/gdi/naomi2/">GDI Files</a></td><td><a href="/datfile/naomi2/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Prologue 21 Multimedia Karaoke System</td><td><a href="/cues/sp21/">Cuesheets</a></td><td><a href="/datfile/sp21/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega RingEdge</td><td></td><td><a href="/datfile/sre/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega RingEdge 2</td><td></td><td><a href="/datfile/sre2/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Saturn</td><td><a href="/cues/ss/">Cuesheets</a></td><td><a href="/datfile/ss/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sega Titan Video</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Sharp X68000</td><td><a href="/cues/x68k/">Cuesheets</a></td><td><a href="/datfile/x68k/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sony PlayStation</td><td><a href="/cues/psx/">Cuesheets</a></td><td><a href="/datfile/psx/">Datfile</a></td><td><a href="/sbi/psx/">SBI</a> | LSD</td><td></td><td><a href="/datfile/psx-bios/">BIOS Datfile</a></td></tr><tr><td>Sony PlayStation 2</td><td><a href="/cues/ps2/">Cuesheets</a></td><td><a href="/datfile/ps2/">Datfile</a></td><td></td><td></td><td><a href="/datfile/ps2-bios/">BIOS Datfile</a></td></tr><tr><td>Sony PlayStation 3</td><td><a href="/cues/ps3/">Cuesheets</a></td><td><a href="/datfile/ps3/">Datfile</a></td><td></td><td><a href="/keys/ps3/">HEX</a> | <a href="/dkeys/ps3/">TXT</a></td><td></td></tr><tr><td>Sony PlayStation 4</td><td></td><td><a href="/datfile/ps4/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sony PlayStation 5</td><td></td><td><a href="/datfile/ps5/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Sony PlayStation Portable</td><td></td><td><a href="/datfile/psp/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>TAB-Austria Quizard</td><td><a href="/cues/quizard/">Cuesheets</a></td><td><a href="/datfile/quizard/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Tao iKTV</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Tomy Kiss-Site</td><td><a href="/cues/ksite/">Cuesheets</a></td><td><a href="/datfile/ksite/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>Video CD</td><td><a href="/cues/vcd/">Cuesheets</a></td><td><a href="/datfile/vcd/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>VM Labs NUON</td><td></td><td><a href="/datfile/nuon/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>VTech V.Flash & V.Smile Pro</td><td><a href="/cues/vflash/">Cuesheets</a></td><td><a href="/datfile/vflash/">Datfile</a></td><td></td><td></td><td></td></tr><tr><td>ZAPiT Games Game Wave Family Entertainment System</td><td></td><td><a href="/datfile/gamewave/">Datfile</a></td><td></td><td></td><td></td></tr></table>'


def main():


    refined = re.sub(r'<table.*?>','',table_content)
    refined = re.sub(r'</table>','',refined)
    refined = re.sub(r'|','',refined)
    refined = re.sub(r'<td></td>','',refined)

    refined = re.split(r'<tr.*?>',refined)
  
    output = {}
    for tr in refined:
        soup = BeautifulSoup(tr, 'html.parser')


        if soup.td != None:
            output.update({ soup.td.text: {} })
        
        all_a = soup.find_all("a")

        for a in all_a:
            output[soup.td.text].update( { a.text: a.attrs['href'] } )



    with open('systems.json', 'w') as f:
        print(json.dumps(output,indent=4),file=f)


    print(json.dumps(output,indent=4))


if __name__ == "__main__":
    main()

